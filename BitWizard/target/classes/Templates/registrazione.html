<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrazione Utente</title>
    <script>
    function inviaForm() {
        const form = document.getElementById('signup');
        const formData = new FormData(form); // Manteniamo il file nel suo formato binario

        inviaDati(formData); // Inviamo il formData così com'è, inclusi i file
    }

    function inviaDati(formData) {
        fetch('/api/utente/signup', {
            method: 'POST',
            body: formData // Invia il formData direttamente, il browser gestirà il boundary
        })
        .then(response => {
            if (response.ok) {
                mostraFeedback(true);
            } else {
                return response.text().then(text => { throw new Error(text) });
            }
        })
        .catch(error => {
            console.error('Errore:', error.message);
            mostraFeedback(false);
        });
    }
    </script>
</head>
<body>

    <h2>Registrazione Nuovo Utente</h2>

    <form id="signup" action="/utente/signup" method="POST" enctype="multipart/form-data" onsubmit="event.preventDefault(); inviaForm();">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" required><br><br>

        <label for="cognome">Cognome:</label>
        <input type="text" id="cognome" name="cognome" required><br><br>

        <label for="numeroTelefono">Numero di Telefono:</label>
        <input type="text" id="numeroTelefono" name="numeroTelefono" required><br><br>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required><br><br>

        <label for="password">Password:</label>
        <input type="password" id="password" name="password" required><br><br>

        <label for="dataNascita">Data di Nascita:</label>
        <input type="date" id="dataNascita" name="dataNascita" required><br><br>

        <label for="descrizione">Descrizione:</label>
        <textarea id="descrizione" name="descrizione"></textarea><br><br>

        <label for="ruoloId">Ruolo (ID):</label>
        <input type="number" id="ruoloId" name="ruoloId" required><br><br>

        <label for="tagIds">Tag (ID separati da virgola):</label>
        <input type="text" id="tagIds" name="tagIds"><br><br>
		
        <label for="imgProfilo">Immagine Profilo:</label>
        <input type="file" id="imgProfilo" name="imgProfilo"><br><br>

        <input type="submit" value="Crea Viaggio">
    </form>

</body>
</html>