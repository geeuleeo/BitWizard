<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creazione Viaggio</title>
    <script>
    function inviaForm() {
    	const form = document.getElementById('creaViaggioForm');
        const formData = new FormData(form); // Manteniamo il file nel suo formato binario

        inviaDati(formData); // Inviamo il formData così com'è, inclusi i file
    }

    function inviaDati(formData) {
    	fetch('/api/viaggi/crea', {
            method: 'POST',
            body: formData // Invia il formData direttamente, il browser gestirà il boundary
        })
        .then(response => {
            if (response.ok) {
                mostraFeedback(true);
            } else {
                return response.text().then(text => { throw new Error(text) });
            }
        })
        .catch(error => {
            console.error('Errore:', error.message);
            mostraFeedback(false);
        });
    }
    </script>
</head>
<body>
    <h1>Creazione di un nuovo viaggio</h1>
    <form id="creaViaggioForm" action="viaggi/crea" method="post" onsubmit="event.preventDefault(); inviaForm();">
        <label for="nome">Nome del Viaggio:</label>
        <input type="text" id="nome" name="nome" required><br><br>

        <label for="luogoPartenza">Luogo di Partenza:</label>
        <input type="text" id="luogoPartenza" name="luogoPartenza" required><br><br>

        <label for="luogoArrivo">Luogo di Arrivo:</label>
        <input type="text" id="luogoArrivo" name="luogoArrivo" required><br><br>

        <label for="dataPartenza">Data di Partenza:</label>
        <input type="date" id="dataPartenza" name="dataPartenza" required><br><br>

        <label for="dataRitorno">Data di Ritorno:</label>
        <input type="date" id="dataRitorno" name="dataRitorno" required><br><br>

        <label for="dataScadenza">Data di Scadenza Iscrizione:</label>
        <input type="date" id="dataScadenza" name="dataScadenza" required><br><br>

        <label for="numPartMin">Numero di Partecipanti Minimo:</label>
        <input type="number" id="numPartMin" name="numPartMin" required><br><br>

        <label for="numPartMax">Numero di Partecipanti Massimo:</label>
        <input type="number" id="numPartMax" name="numPartMax" required><br><br>

        <label for="prezzo">Prezzo (€):</label>
        <input type="number" step="0.01" id="prezzo" name="prezzo" required><br><br>

        <label for="etaMin">Età Minima:</label>
        <input type="number" id="etaMin" name="etaMin" required><br><br>

        <label for="etaMax">Età Massima:</label>
        <input type="number" id="etaMax" name="etaMax" required><br><br>

        <label for="tagIds">Tag (separati da virgola, es. 1,2,3):</label>
        <input type="text" id="tagIds" name="tagIds"><br><br>

        <label for="immagineCopertina">Immagine Copertina del Viaggio:</label>
		<input type="file" id="immagineCopertina" name="immagineCopertina" accept="image/*"><br><br>


        <input type="submit" value="Crea Viaggio">
    </form>
    
    <p id="feedback"></p>
    
</body>
</html>